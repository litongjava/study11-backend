<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>什么是Manim</title>
    <link rel="stylesheet" href="animation-player.css">
</head>
<body>
<div class="main-container">
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
        <div class="loading-progress">
            <div class="loading-progress-bar">
                <div class="loading-progress-fill" id="loadingProgressFill"></div>
            </div>
            <div class="loading-progress-text" id="loadingProgressText">Progress: 0 / 0（0%）</div>
        </div>
    </div>
    <div class="animation-container">


        <div class="cache-indicator" id="cacheIndicator">Use cached audio</div>
        <div class="scene-number" id="sceneNumber">1</div>

        <svg class="manim-scene" viewBox="0 0 800 400">
            <!-- 场景标题 -->
            <text x="800" y="30" text-anchor="middle" fill="#2c3e50" font-size="24" font-weight="300"
                  class="scene-title" id="sceneTitle">
                动画制作引言
            </text>

            <!-- 视觉面板 -->
            <g id="visualPanel">
                <!-- 场景1: 动画制作引言 -->
                <g id="scene1">
                    <!-- 动画图标 -->
                    <circle cx="400" cy="150" r="60" fill="#3498db" opacity="0.2"/>
                    <path d="M 370 130 L 430 150 L 370 170 Z" fill="#3498db"/>

                    <!-- 数学符号 -->
                    <text x="300" y="250" font-size="30" fill="#e74c3c">∫</text>
                    <text x="350" y="250" font-size="30" fill="#2ecc71">∞</text>
                    <text x="400" y="250" font-size="30" fill="#f39c12">∑</text>
                    <text x="450" y="250" font-size="30" fill="#9b59b6">∂</text>
                    <text x="500" y="250" font-size="30" fill="#1abc9c">√</text>

                    <!-- 连接线 -->
                    <line x1="400" y1="150" x2="300" y2="240" stroke="#95a5a6" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="400" y1="150" x2="500" y2="240" stroke="#95a5a6" stroke-width="2" stroke-dasharray="5,5"/>
                </g>

                <!-- 场景2: Manim基本概念 -->
                <g id="scene2" style="display: none;">
                    <!-- Manim Logo -->
                    <rect x="350" y="100" width="100" height="100" rx="10" fill="#3498db" opacity="0.2"/>
                    <text x="400" y="155" text-anchor="middle" font-size="24" fill="#3498db" font-weight="bold">Manim</text>

                    <!-- 3Blue1Brown图标 -->
                    <circle cx="250" cy="150" r="30" fill="#9b59b6"/>
                    <text x="250" y="155" text-anchor="middle" font-size="14" fill="white">3B1B</text>

                    <!-- Python图标 -->
                    <circle cx="550" cy="150" r="30" fill="#f39c12"/>
                    <text x="550" y="155" text-anchor="middle" font-size="14" fill="white">Py</text>

                    <!-- 连接箭头 -->
                    <line x1="280" y1="150" x2="350" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <line x1="450" y1="150" x2="520" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- 功能描述 -->
                    <text x="400" y="220" text-anchor="middle" font-size="16" fill="#2c3e50">数学动画库</text>
                    <text x="400" y="250" text-anchor="middle" font-size="16" fill="#2c3e50">精确可视化</text>
                </g>

                <!-- 场景3: Manim工作原理 -->
                <g id="scene3" style="display: none;">
                    <!-- Scene框 -->
                    <rect x="200" y="100" width="150" height="80" rx="10" fill="#3498db" opacity="0.2" stroke="#3498db" stroke-width="2"/>
                    <text x="275" y="130" text-anchor="middle" font-size="16" fill="#3498db">Scene</text>
                    <text x="275" y="155" text-anchor="middle" font-size="14" fill="#2c3e50">construct()</text>

                    <!-- Animation框 -->
                    <rect x="400" y="100" width="150" height="80" rx="10" fill="#2ecc71" opacity="0.2" stroke="#2ecc71" stroke-width="2"/>
                    <text x="475" y="130" text-anchor="middle" font-size="16" fill="#2ecc71">Animation</text>
                    <text x="475" y="155" text-anchor="middle" font-size="14" fill="#2c3e50">play()</text>

                    <!-- 时间轴 -->
                    <line x1="200" y1="250" x2="600" y2="250" stroke="#95a5a6" stroke-width="2"/>
                    <circle cx="250" cy="250" r="8" fill="#3498db"/>
                    <circle cx="350" cy="250" r="8" fill="#2ecc71"/>
                    <circle cx="450" cy="250" r="8" fill="#f39c12"/>
                    <circle cx="550" cy="250" r="8" fill="#9b59b6"/>

                    <!-- 箭头连接 -->
                    <line x1="275" y1="180" x2="250" y2="242" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <line x1="475" y1="180" x2="358" y2="242" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>
                </g>

                <!-- 场景4: 基本几何对象 -->
                <g id="scene4" style="display: none;">
                    <!-- 圆形 -->
                    <circle cx="250" cy="150" r="40" fill="#3498db" opacity="0.3" stroke="#3498db" stroke-width="2"/>
                    <text x="250" y="210" text-anchor="middle" font-size="14" fill="#2c3e50">Circle()</text>

                    <!-- 正方形 -->
                    <rect x="350" y="110" width="80" height="80" fill="#2ecc71" opacity="0.3" stroke="#2ecc71" stroke-width="2"/>
                    <text x="390" y="210" text-anchor="middle" font-size="14" fill="#2c3e50">Square()</text>

                    <!-- 三角形 -->
                    <polygon points="500,190 540,110 580,190" fill="#f39c12" opacity="0.3" stroke="#f39c12" stroke-width="2"/>
                    <text x="540" y="210" text-anchor="middle" font-size="14" fill="#2c3e50">Triangle()</text>

                    <!-- 样式说明 -->
                    <rect x="300" y="250" width="200" height="60" rx="5" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1"/>
                    <text x="400" y="270" text-anchor="middle" font-size="12" fill="#2c3e50">set_fill()</text>
                    <text x="400" y="290" text-anchor="middle" font-size="12" fill="#2c3e50">set_stroke()</text>
                </g>

                <!-- 场景5: 文本和数学公式 -->
                <g id="scene5" style="display: none;">
                    <!-- 普通文本 -->
                    <rect x="200" y="100" width="120" height="50" rx="5" fill="#3498db" opacity="0.2"/>
                    <text x="260" y="130" text-anchor="middle" font-size="14" fill="#3498db">Text("Hello")</text>

                    <!-- LaTeX公式 -->
                    <rect x="350" y="100" width="150" height="50" rx="5" fill="#2ecc71" opacity="0.2"/>
                    <text x="425" y="130" text-anchor="middle" font-size="14" fill="#2ecc71">MathTex("f(x)=x^2")</text>

                    <!-- 渲染效果 -->
                    <rect x="530" y="100" width="120" height="50" rx="5" fill="#f39c12" opacity="0.2"/>
                    <text x="590" y="130" text-anchor="middle" font-size="14" fill="#f39c12">渲染</text>

                    <!-- 公式示例 -->
                    <text x="400" y="200" text-anchor="middle" font-size="24" fill="#2c3e50">f(x) = x²</text>
                    <text x="400" y="240" text-anchor="middle" font-size="16" fill="#7f8c8d">二次函数</text>
                </g>

                <!-- 场景6: 对象变换基础 -->
                <g id="scene6" style="display: none;">
                    <!-- 正方形变换序列 -->
                    <rect id="transformSquare" x="200" y="120" width="60" height="60" fill="#3498db" opacity="0.3"/>

                    <!-- 变换箭头 -->
                    <line x1="280" y1="150" x2="350" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="315" y="140" text-anchor="middle" font-size="12" fill="#2c3e50">shift(RIGHT)</text>

                    <line x1="400" y1="150" x2="470" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="435" y="140" text-anchor="middle" font-size="12" fill="#2c3e50">scale(2)</text>

                    <line x1="520" y1="150" x2="590" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="555" y="140" text-anchor="middle" font-size="12" fill="#2c3e50">rotate(π/4)</text>

                    <!-- 变换后的正方形 -->
                    <g transform="translate(100,0) rotate(45,570,150) scale(2,570,150)">
                        <rect x="540" y="120" width="60" height="60" fill="#2ecc71" opacity="0.3"/>
                    </g>

                    <!-- 代码示例 -->
                    <rect x="300" y="250" width="200" height="60" rx="5" fill="#2c3e50" opacity="0.1"/>
                    <text x="400" y="270" text-anchor="middle" font-size="12" fill="#2c3e50">square.animate</text>
                    <text x="400" y="290" text-anchor="middle" font-size="12" fill="#2c3e50">.shift(RIGHT).scale(2).rotate(PI/4)</text>
                </g>

                <!-- 场景7: 颜色和样式 -->
                <g id="scene7" style="display: none;">
                    <!-- 不同颜色的圆形 -->
                    <circle cx="250" cy="150" r="30" fill="#3498db" opacity="0.7"/>
                    <circle cx="350" cy="150" r="30" fill="#2ecc71" opacity="0.7"/>
                    <circle cx="450" cy="150" r="30" fill="#f39c12" opacity="0.7"/>
                    <circle cx="550" cy="150" r="30" fill="#9b59b6" opacity="0.7"/>

                    <!-- 透明度示例 -->
                    <rect x="220" y="220" width="60" height="60" fill="#3498db" opacity="0.9"/>
                    <rect x="240" y="240" width="60" height="60" fill="#3498db" opacity="0.6"/>
                    <rect x="260" y="260" width="60" height="60" fill="#3498db" opacity="0.3"/>

                    <!-- 样式说明 -->
                    <text x="400" y="230" text-anchor="middle" font-size="14" fill="#2c3e50">set_color()</text>
                    <text x="400" y="250" text-anchor="middle" font-size="14" fill="#2c3e50">set_fill()</text>
                    <text x="400" y="270" text-anchor="middle" font-size="14" fill="#2c3e50">set_opacity()</text>
                </g>

                <!-- 场景8: 坐标系统 -->
                <g id="scene8" style="display: none;">
                    <!-- 坐标轴 -->
                    <line x1="200" y1="200" x2="600" y2="200" stroke="#34495e" stroke-width="2"/>
                    <line x1="400" y1="50" x2="400" y2="350" stroke="#34495e" stroke-width="2"/>

                    <!-- 原点 -->
                    <circle cx="400" cy="200" r="5" fill="#e74c3c"/>
                    <text x="410" y="195" font-size="14" fill="#e74c3c">(0,0)</text>

                    <!-- 方向向量 -->
                    <line x1="400" y1="200" x2="450" y2="200" stroke="#3498db" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="455" y="195" font-size="14" fill="#3498db">RIGHT</text>

                    <line x1="400" y1="200" x2="400" y2="150" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="405" y="145" font-size="14" fill="#2ecc71">UP</text>

                    <!-- 对象位置 -->
                    <rect x="500" y="100" width="50" height="50" fill="#f39c12" opacity="0.3"/>
                    <text x="525" y="170" text-anchor="middle" font-size="12" fill="#2c3e50">[1, 2, 0]</text>
                </g>

                <!-- 场景9: 函数图像绘制 -->
                <g id="scene9" style="display: none;">
                    <!-- 坐标轴 -->
                    <line x1="200" y1="200" x2="600" y2="200" stroke="#34495e" stroke-width="2"/>
                    <line x1="400" y1="50" x2="400" y2="350" stroke="#34495e" stroke-width="2"/>

                    <!-- 二次函数曲线 -->
                    <path d="M 200 300 Q 300 100 400 200 Q 500 300 600 300" fill="none" stroke="#3498db" stroke-width="3"/>

                    <!-- 函数标签 -->
                    <text x="500" y="250" font-size="18" fill="#3498db">f(x) = x²</text>

                    <!-- 坐标标记 -->
                    <circle cx="300" cy="250" r="4" fill="#e74c3c"/>
                    <text x="310" y="245" font-size="12" fill="#e74c3c">(-1,1)</text>

                    <circle cx="500" cy="250" r="4" fill="#e74c3c"/>
                    <text x="510" y="245" font-size="12" fill="#e74c3c">(1,1)</text>
                </g>

                <!-- 场景10: 变换动画类型 -->
                <g id="scene10" style="display: none;">
                    <!-- Create动画 -->
                    <rect x="150" y="100" width="80" height="40" rx="5" fill="#3498db" opacity="0.3"/>
                    <text x="190" y="160" text-anchor="middle" font-size="12" fill="#2c3e50">Create</text>

                    <!-- Transform动画 -->
                    <circle cx="300" cy="120" r="20" fill="#2ecc71" opacity="0.3"/>
                    <rect x="280" y="160" width="40" height="40" fill="#2ecc71" opacity="0.3"/>
                    <text x="300" y="220" text-anchor="middle" font-size="12" fill="#2c3e50">Transform</text>

                    <!-- Fade动画 -->
                    <rect x="420" y="100" width="80" height="40" rx="5" fill="#f39c12" opacity="0.3"/>
                    <rect x="420" y="160" width="80" height="40" rx="5" fill="#f39c12" opacity="0"/>
                    <text x="460" y="220" text-anchor="middle" font-size="12" fill="#2c3e50">FadeIn/Out</text>

                    <!-- ReplacementTransform -->
                    <circle cx="600" cy="120" r="20" fill="#9b59b6" opacity="0.3"/>
                    <polygon points="580,160 600,140 620,160 600,180" fill="#9b59b6" opacity="0.3"/>
                    <text x="600" y="220" text-anchor="middle" font-size="12" fill="#2c3e50">Replacement</text>
                </g>

                <!-- 场景11: 组合对象操作 -->
                <g id="scene11" style="display: none;">
                    <!-- VGroup示例 -->
                    <g id="vgroupExample">
                        <circle cx="250" cy="120" r="20" fill="#3498db" opacity="0.3"/>
                        <rect x="230" y="160" width="40" height="40" fill="#2ecc71" opacity="0.3"/>
                        <polygon points="230,240 250,220 270,240 250,260" fill="#f39c12" opacity="0.3"/>
                    </g>
                    <rect x="210" y="100" width="80" height="180" rx="5" fill="none" stroke="#95a5a6" stroke-dasharray="5,5"/>
                    <text x="250" y="300" text-anchor="middle" font-size="12" fill="#2c3e50">VGroup</text>

                    <!-- arrange示例 -->
                    <circle cx="400" cy="120" r="15" fill="#3498db" opacity="0.3"/>
                    <rect x="420" y="110" width="30" height="30" fill="#2ecc71" opacity="0.3"/>
                    <polygon points="455,125 470,110 485,125 470,140" fill="#f39c12" opacity="0.3"/>
                    <text x="470" y="160" text-anchor="middle" font-size="12" fill="#2c3e50">arrange()</text>

                    <!-- next_to示例 -->
                    <rect x="550" y="100" width="50" height="50" fill="#3498db" opacity="0.3"/>
                    <circle cx="620" cy="125" r="15" fill="#2ecc71" opacity="0.3"/>
                    <text x="620" y="160" text-anchor="middle" font-size="12" fill="#2c3e50">next_to()</text>
                </g>

                <!-- 场景12: 时间控制和动画序列 -->
                <g id="scene12" style="display: none;">
                    <!-- 时间轴 -->
                    <line x1="200" y1="150" x2="600" y2="150" stroke="#95a5a6" stroke-width="2"/>

                    <!-- 动画序列 -->
                    <circle cx="250" cy="150" r="10" fill="#3498db"/>
                    <text x="250" y="170" text-anchor="middle" font-size="10" fill="#2c3e50">A1</text>

                    <circle cx="320" cy="150" r="10" fill="#2ecc71"/>
                    <text x="320" y="170" text-anchor="middle" font-size="10" fill="#2c3e50">A2</text>

                    <circle cx="400" cy="150" r="10" fill="#f39c12"/>
                    <text x="400" y="170" text-anchor="middle" font-size="10" fill="#2c3e50">A3</text>

                    <circle cx="480" cy="150" r="10" fill="#9b59b6"/>
                    <text x="480" y="170" text-anchor="middle" font-size="10" fill="#2c3e50">A4</text>

                    <!-- 并行动画 -->
                    <line x1="200" y1="250" x2="600" y2="250" stroke="#95a5a6" stroke-width="2"/>
                    <circle cx="250" cy="250" r="10" fill="#3498db"/>
                    <circle cx="250" cy="250" r="10" fill="#2ecc71"/>
                    <circle cx="250" cy="250" r="10" fill="#f39c12"/>
                    <text x="250" y="270" text-anchor="middle" font-size="10" fill="#2c3e50">并行</text>

                    <!-- 时间控制 -->
                    <rect x="300" y="230" width="80" height="40" rx="5" fill="#ecf0f1" stroke="#bdc3c7"/>
                    <text x="340" y="250" text-anchor="middle" font-size="10" fill="#2c3e50">run_time=2</text>
                </g>

                <!-- 场景13: 相机和视角控制 -->
                <g id="scene13" style="display: none;">
                    <!-- 相机图标 -->
                    <rect x="250" y="120" width="60" height="40" rx="10" fill="#3498db" opacity="0.3"/>
                    <circle cx="280" cy="140" r="8" fill="#2c3e50"/>
                    <text x="280" y="160" text-anchor="middle" font-size="10" fill="#2c3e50">相机</text>

                    <!-- 视野范围 -->
                    <polygon points="350,100 450,140 350,180" fill="#2ecc71" opacity="0.3"/>
                    <text x="400" y="200" text-anchor="middle" font-size="12" fill="#2c3e50">视野</text>

                    <!-- 缩放示例 -->
                    <rect x="500" y="100" width="40" height="40" fill="#f39c12" opacity="0.3"/>
                    <rect x="510" y="110" width="20" height="20" fill="#f39c12" opacity="0.3"/>
                    <text x="520" y="160" text-anchor="middle" font-size="12" fill="#2c3e50">zoom()</text>

                    <!-- 3D视角 -->
                    <polygon points="650,100 680,120 680,160 650,180 620,160 620,120" fill="#9b59b6" opacity="0.3"/>
                    <text x="650" y="200" text-anchor="middle" font-size="12" fill="#2c3e50">3D视角</text>
                </g>

                <!-- 场景14: 实际应用示例 -->
                <g id="scene14" style="display: none;">
                    <!-- 勾股定理图示 -->
                    <polygon points="300,200 400,200 400,100" fill="none" stroke="#3498db" stroke-width="2"/>
                    <text x="350" y="190" text-anchor="middle" font-size="12" fill="#3498db">c</text>
                    <text x="410" y="150" text-anchor="middle" font-size="12" fill="#3498db">a</text>
                    <text x="340" y="220" text-anchor="middle" font-size="12" fill="#3498db">b</text>

                    <!-- 三个正方形 -->
                    <rect x="250" y="220" width="50" height="50" fill="#2ecc71" opacity="0.3"/>
                    <text x="275" y="285" text-anchor="middle" font-size="12" fill="#2c3e50">b²</text>

                    <rect x="420" y="50" width="50" height="50" fill="#f39c12" opacity="0.3"/>
                    <text x="445" y="115" text-anchor="middle" font-size="12" fill="#2c3e50">a²</text>

                    <polygon points="520,200 570,150 620,200 570,250" fill="#9b59b6" opacity="0.3"/>
                    <text x="570" y="270" text-anchor="middle" font-size="12" fill="#2c3e50">c²</text>

                    <!-- 公式 -->
                    <text x="400" y="320" text-anchor="middle" font-size="18" fill="#e74c3c">a² + b² = c²</text>
                </g>

                <!-- 场景15: 高级功能概览 -->
                <g id="scene15" style="display: none;">
                    <!-- 3D图形 -->
                    <polygon points="250,120 280,100 310,120 280,140" fill="#3498db" opacity="0.3"/>
                    <polygon points="250,120 280,140 280,170 250,150" fill="#2ecc71" opacity="0.3"/>
                    <polygon points="280,140 310,120 310,150 280,170" fill="#f39c12" opacity="0.3"/>
                    <text x="280" y="190" text-anchor="middle" font-size="10" fill="#2c3e50">3D图形</text>

                    <!-- 图表 -->
                    <rect x="350" y="100" width="60" height="10" fill="#3498db"/>
                    <rect x="350" y="120" width="40" height="10" fill="#2ecc71"/>
                    <rect x="350" y="140" width="50" height="10" fill="#f39c12"/>
                    <text x="380" y="170" text-anchor="middle" font-size="10" fill="#2c3e50">图表</text>

                    <!-- 物理模拟 -->
                    <circle cx="480" cy="120" r="15" fill="#9b59b6" opacity="0.3"/>
                    <line x1="480" y1="120" x2="480" y2="160" stroke="#9b59b6" stroke-width="2" stroke-dasharray="3,3"/>
                    <text x="480" y="180" text-anchor="middle" font-size="10" fill="#2c3e50">物理模拟</text>

                    <!-- 参数方程 -->
                    <path d="M 550 100 Q 570 80 590 100 Q 610 120 590 140 Q 570 160 550 140 Q 530 120 550 100" fill="none" stroke="#1abc9c" stroke-width="2"/>
                    <text x="570" y="170" text-anchor="middle" font-size="10" fill="#2c3e50">参数方程</text>
                </g>

                <!-- 场景16: 安装和环境设置 -->
                <g id="scene16" style="display: none;">
                    <!-- 终端窗口 -->
                    <rect x="250" y="100" width="300" height="150" rx="5" fill="#2c3e50" opacity="0.9"/>
                    <rect x="260" y="110" width="280" height="20" fill="#34495e"/>
                    <text x="270" y="125" font-size="12" fill="#ecf0f1">&gt; pip install manim</text>
                    <text x="270" y="150" font-size="12" fill="#ecf0f1">&gt; manim -pql script.py SceneName</text>

                    <!-- Python图标 -->
                    <circle cx="400" y="280" r="30" fill="#f39c12"/>
                    <text x="400" y="285" text-anchor="middle" font-size="14" fill="white">Py</text>

                    <!-- 文件图标 -->
                    <rect x="480" y="260" width="40" height="50" rx="3" fill="#3498db" opacity="0.3"/>
                    <text x="500" y="290" text-anchor="middle" font-size="10" fill="#2c3e50">.py</text>
                </g>
            </g>

            <!-- 箭头定义 -->
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7"
                        refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#95a5a6"/>
                </marker>
            </defs>
        </svg>
    </div>

    <div class="subtitle-container">
        <div class="subtitle" id="subtitle"></div>
    </div>

    <div class="controls">
        <button class="control-btn" id="playBtn" title="播放" disabled>
            <span id="playIcon">▶</span>
        </button>
        <button class="control-btn" id="muteBtn" title="静音">
            <span id="muteIcon">🔊</span>
        </button>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
                <div class="progress-handle" id="progressHandle"></div>
            </div>
            <div class="time-display" id="timeDisplay">00:00 / 00:00</div>
        </div>
    </div>
</div>

<div class="footer">
    © 2023 https://study11.ai/
</div>

<!-- 为每个场景创建一个音频元素 -->
<div id="audioContainer"></div>

<!-- 引入公共模块 -->
<script src="animation-player-utils.js"></script>

<script>
    // 定义场景数据
    const manimScenes = [
        {
            title: "动画制作引言",
            subtitle: "大家好！在当今的数字时代，动画已经成为教学和演示中不可或缺的工具。想象一下，如果我们可以用代码来创建精确、美观的数学动画，那该多好呢？今天我们要介绍的就是这样一个神奇的工具——Manim。Manim是一个专门用于创建数学动画的Python库，它可以帮助我们把抽象的数学概念可视化，让学习变得更加直观和有趣。",
            action: () => showScene(1, "动画制作引言")
        },
        {
            title: "Manim基本概念",
            subtitle: "那么，什么是Manim呢？Manim是Mathematical Animation的缩写，意为\"数学动画\"。它是由著名数学家和教育家3Blue1Brown开发的一个Python库。Manim的核心功能是让我们能够通过编写Python代码来创建精确的数学动画。与传统的动画软件不同，Manim专注于数学内容，可以轻松地创建几何图形、函数图像、变换过程等数学相关的动画。",
            action: () => showScene(2, "Manim基本概念")
        },
        {
            title: "Manim工作原理",
            subtitle: "Manim是如何工作的呢？在Manim中，一切动画都是通过\"场景\"(Scene)来组织的。每个场景包含一系列的\"动画\"(Animation)，这些动画按照时间顺序播放。我们通过继承Scene类来创建自己的动画场景，然后在construct方法中定义我们要展示的对象和动画。Manim会自动处理对象之间的过渡和动画效果，让我们能够专注于内容本身而不是动画技术细节。",
            action: () => showScene(3, "Manim工作原理")
        },
        {
            title: "基本几何对象",
            subtitle: "让我们来看看Manim中的一些基本几何对象。在Manim中，我们可以轻松创建各种几何图形。比如Circle()创建圆形，Square()创建正方形，Triangle()创建三角形。这些对象都有丰富的属性可以调整，比如颜色、大小、位置等。我们可以通过set_fill()方法设置填充颜色，通过set_stroke()方法设置边框样式。这些基本对象是构建复杂动画的基础元素。",
            action: () => showScene(4, "基本几何对象")
        },
        {
            title: "文本和数学公式",
            subtitle: "在数学动画中，文本和公式是必不可少的元素。Manim提供了强大的文本处理功能。我们可以使用Text()来添加普通文本，使用Tex()或MathTex()来添加LaTeX格式的数学公式。比如，MathTex(r\"f(x) = x^2\")可以创建一个优美的二次函数公式。Manim会自动处理公式的排版和渲染，确保数学表达式的专业性和准确性。",
            action: () => showScene(5, "文本和数学公式")
        },
        {
            title: "对象变换基础",
            subtitle: "现在我们来看看如何让对象动起来。在Manim中，我们可以对对象进行各种变换操作。比如使用animate.shift()来移动对象，animate.scale()来缩放对象，animate.rotate()来旋转对象。这些变换可以组合使用，创造出丰富的动画效果。例如，square.animate.shift(RIGHT).scale(2).rotate(PI/4)可以让正方形向右移动、放大两倍并旋转45度。",
            action: () => showScene(6, "对象变换基础")
        },
        {
            title: "颜色和样式",
            subtitle: "美观的视觉效果对于动画很重要。在Manim中，我们可以精细地控制对象的外观。通过set_color()方法可以设置对象的颜色，set_fill()控制填充，set_stroke()控制边框。我们还可以使用set_opacity()调整透明度。Manim支持各种颜色表示方法，包括预定义颜色名称、RGB值和十六进制颜色码，让我们能够创建出色彩丰富的动画。",
            action: () => showScene(7, "颜色和样式")
        },
        {
            title: "坐标系统",
            subtitle: "理解坐标系统对于精确放置对象至关重要。在Manim中，屏幕中心是坐标原点(0,0)。水平向右为正X方向，垂直向上为正Y方向。我们可以使用LEFT、RIGHT、UP、DOWN等预定义方向向量，也可以使用坐标元组如[1, 2, 0]来精确定位。通过get_center()、get_top()、get_bottom()等方法可以获取对象的特定位置，这在创建复杂布局时非常有用。",
            action: () => showScene(8, "坐标系统")
        },
        {
            title: "函数图像绘制",
            subtitle: "绘制函数图像是Manim的强大功能之一。我们可以使用Axes类创建坐标轴，然后通过plot()方法绘制函数图像。例如，axes.plot(lambda x: x**2)可以绘制二次函数。我们还可以设置函数的定义域、颜色、粗细等属性。通过add_coordinates()方法可以添加坐标标记，让图像更加完整和专业。这对于数学教学和演示非常有价值。",
            action: () => showScene(9, "函数图像绘制")
        },
        {
            title: "变换动画类型",
            subtitle: "Manim提供了多种变换动画类型来丰富我们的动画效果。Create动画逐渐显示一个对象，Transform将一个对象变形为另一个对象，ReplacementTransform替换对象同时保持动画连续性。FadeIn和FadeOut控制对象的淡入淡出，GrowFromCenter从中心生长。每种变换都有其特定的使用场景，选择合适的变换类型可以让动画更加自然和专业。",
            action: () => showScene(10, "变换动画类型")
        },
        {
            title: "组合对象操作",
            subtitle: "在实际应用中，我们经常需要将多个对象组合成复杂结构。在Manim中，可以使用VGroup将多个对象组合成一个组，这样就可以对整个组进行统一操作。使用arrange()方法可以自动排列对象，next_to()可以将对象放置在另一个对象旁边。通过add()和remove()方法可以动态添加或移除组内对象，这为我们创建复杂的动画场景提供了极大的灵活性。",
            action: () => showScene(11, "组合对象操作")
        },
        {
            title: "时间控制和动画序列",
            subtitle: "精确的时间控制是制作高质量动画的关键。在Manim中，我们可以通过run_time参数控制动画持续时间，通过wait()方法添加暂停。使用AnimationGroup可以并行播放多个动画，或者通过lag_ratio参数控制动画的时序关系。我们还可以使用self.play()连续播放动画，通过合理的时序安排，创造出流畅而富有节奏感的动画效果。",
            action: () => showScene(12, "时间控制和动画序列")
        },
        {
            title: "相机和视角控制",
            subtitle: "Manim的相机系统允许我们控制观众的视角。我们可以使用move_to()移动相机位置，通过set_frame_width()调整视野范围。zoom()方法可以实现缩放效果，而set_camera_orientation()可以设置三维视角。这些相机操作让我们能够突出重点内容，引导观众注意力，创造出更具表现力的动画效果。",
            action: () => showScene(13, "相机和视角控制")
        },
        {
            title: "实际应用示例",
            subtitle: "让我们通过一个实际例子来巩固所学知识。假设我们要演示勾股定理的证明过程。我们可以先创建一个直角三角形，然后构造三个正方形分别对应三边。通过适当的变换动画，展示面积关系的推导过程。这个例子综合运用了我们学到的对象创建、变换、分组、动画控制等技术，展示了Manim在数学教育中的强大能力。",
            action: () => showScene(14, "实际应用示例")
        },
        {
            title: "高级功能概览",
            subtitle: "除了基础功能，Manim还提供许多高级特性。三维图形支持让我们可以创建立体几何动画，图表功能可以制作统计图表，物理模拟可以演示力学过程。参数方程和极坐标支持复杂的数学曲线，自定义动画类允许创建独特的动画效果。这些高级功能大大扩展了Manim的应用范围，满足更专业的制作需求。",
            action: () => showScene(15, "高级功能概览")
        },
        {
            title: "安装和环境设置",
            subtitle: "要开始使用Manim，首先需要安装它。可以通过pip install manim命令安装社区版。安装完成后，我们就可以创建.py文件编写动画代码。运行manim -pql script_name.py SceneName命令可以渲染并预览动画。虽然安装过程可能需要一些Python环境知识，但一旦设置完成，我们就可以专注于创作精彩的数学动画了。",
            action: () => showScene(16, "安装和环境设置")
        }
    ];

    // 场景显示函数
    function showScene(sceneNumber, title) {
        // 隐藏所有场景
        for (let i = 1; i <= manimScenes.length; i++) {
            const scene = document.getElementById(`scene${i}`);
            if (scene) {
                scene.style.display = 'none';
            }
        }

        // 显示当前场景
        const currentScene = document.getElementById(`scene${sceneNumber}`);
        if (currentScene) {
            currentScene.style.display = 'block';
        }

        // 更新标题和场景编号
        const sceneTitle = document.getElementById('sceneTitle');
        const sceneNumberElement = document.getElementById('sceneNumber');

        if (sceneTitle) {
            sceneTitle.textContent = title;
            sceneTitle.classList.add('active');
        }

        if (sceneNumberElement) {
            sceneNumberElement.textContent = sceneNumber.toString();
        }
    }

    // 初始化动画播放器
    async function initializePlayer() {
        // 获取DOM元素
        const elements = {
            audioContainer: document.getElementById('audioContainer'),
            loading: document.getElementById('loading'),
            playBtn: document.getElementById('playBtn'),
            playIcon: document.getElementById('playIcon'),
            muteBtn: document.getElementById('muteBtn'),
            muteIcon: document.getElementById('muteIcon'),
            progressBar: document.getElementById('progressBar'),
            progressFill: document.getElementById('progressFill'),
            progressHandle: document.getElementById('progressHandle'),
            subtitle: document.getElementById('subtitle'),
            timeDisplay: document.getElementById('timeDisplay'),
            cacheIndicator: document.getElementById('cacheIndicator')
        };

        const player = new AnimationUtils.AnimationPlayer({
            scenes: manimScenes,
            elements: elements,
        });

        // 初始化播放器
        await player.init();

        // 预加载音频
        // 显示 loading 层
        elements.loading?.classList.add('active');

        await player.preloadAllAudio((current, total) => {
            // 百分比（防止 total 为 0）
            const percent = total ? Math.round((current / total) * 100) : 0;

            // DOM 引用
            const fillEl = document.getElementById('loadingProgressFill');
            const textEl = document.getElementById('loadingProgressText');
            const loadingEl = document.getElementById('loading');

            // 进度条宽度与文本
            if (fillEl) fillEl.style.width = percent + '%';
            if (textEl) textEl.textContent = `Progress: ${current} / ${total}（${percent}%）`;

            // 无障碍属性
            if (loadingEl) loadingEl.setAttribute('aria-valuenow', String(percent));
        });

        // 预加载完成后：隐藏 loading，启用播放按钮
        elements.loading?.classList.remove('active');
        elements.playBtn.disabled = false;

        player.setSceneButtons(document.getElementById('sceneButtons'));
        console.log('动画播放器初始化完成');

        await player.playWithErrorHandling()

        window.manimPlayer = player;
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', initializePlayer);

    // 错误处理
    window.addEventListener('error', (e) => {
        console.error('页面错误:', e);
        const loading = document.getElementById('loading');
        if (loading && loading.classList.contains('active')) {
            loading.innerHTML = `
            <div style="color: #e74c3c; text-align: center;">
                <div style="font-size: 2rem;">⚠️</div>
                <div>加载失败，请刷新页面重试</div>
            </div>
        `;
        }
    });
</script>
</body>
</html>