<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三角函数基础</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4eaf5 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 20px;
        }
        .animation-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            position: relative;
            overflow: hidden;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .subtitle-container {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            margin: 5px 0;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .subtitle {
            color: black;
            border-radius: 30px;
            font-size: 1.4rem;
            max-width: 80%;
            text-align: center;
            line-height: 1.5;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .subtitle.active {
            opacity: 1;
        }
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 5px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }
        .control-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: #3498db;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }
        .control-btn:hover {
            background: #2980b9;
            transform: scale(1.1);
        }
        .control-btn:active {
            transform: scale(0.95);
        }
        .control-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }
        .progress-container {
            flex: 1;
            max-width: 400px;
            margin: 0 20px;
            display: flex;
            align-items: center;
        }
        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            border-radius: 4px;
            width: 0%;
            transition: width 0.1s ease;
        }
        .progress-handle {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #3498db;
            border-radius: 50%;
            cursor: grab;
            left: 0%;
        }
        .progress-handle:active {
            cursor: grabbing;
        }
        .time-display {
            min-width: 100px;
            text-align: center;
            font-size: 0.9rem;
            color: #2c3e50;
            font-weight: 500;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .loading.active {
            display: flex;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(52, 152, 219, 0.2);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }
        .loading-text {
            font-size: 1.2rem;
            color: #3498db;
        }
        .cache-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(46, 204, 113, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            display: none;
        }
        .cache-indicator.active {
            display: block;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .trig-scene {
            width: 100%;
            height: 100%;
            position: relative;
        }
        .text-panel {
            position: absolute;
            left: 20px;
            top: 20px;
            width: 40%;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            font-size: 1.1rem;
            line-height: 1.6;
            color: #2c3e50;
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 10;
        }
        .text-panel.active {
            opacity: 1;
        }
        .scene-title {
            position: absolute;
            top: 10px;
            left: 800px;
            transform: translateX(-50%);
            font-size: 1.8rem;
            color: #2c3e50;
            font-weight: 300;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 20;
        }
        .scene-title.active {
            opacity: 1;
        }
        .visual-panel {
            position: absolute;
            right: 20px;
            top: 20px;
            width: 55%;
            height: calc(100% - 40px);
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @media (max-width: 768px) {
            .animation-container {
                padding: 20px;
                min-height: 300px;
            }
            
            .subtitle {
                font-size: 1rem;
                padding: 12px 20px;
            }
            
            .control-btn {
                width: 45px;
                height: 45px;
            }
            
            .text-panel {
                width: 90%;
                left: 5%;
                right: 5%;
                font-size: 0.9rem;
            }
            
            .visual-panel {
                width: 90%;
                left: 5%;
                right: 5%;
                top: auto;
                bottom: 20px;
                height: 40%;
            }
            
            .scene-title {
                left: 50%;
                transform: translateX(-50%);
            }
            
            .time-display {
                min-width: 80px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="animation-container">
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <div class="loading-text">加载中...</div>
            </div>
            <div class="cache-indicator" id="cacheIndicator">使用缓存的音频</div>
            
            <div class="text-panel" id="textPanel">
                <p id="textContent"></p>
            </div>
            
            <div class="scene-title" id="sceneTitle">三角函数基础</div>
            
            <div class="visual-panel">
                <svg class="trig-scene" viewBox="0 0 800 400">
                    <defs>
                        <!-- 渐变定义 -->
                        <linearGradient id="circleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#3498db;stop-opacity:0.2" />
                            <stop offset="100%" style="stop-color:#2980b9;stop-opacity:0.2" />
                        </linearGradient>
                        
                        <linearGradient id="sinGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#e74c3c;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#c0392b;stop-opacity:1" />
                        </linearGradient>
                        
                        <linearGradient id="cosGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#2ecc71;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#27ae60;stop-opacity:1" />
                        </linearGradient>
                        
                        <linearGradient id="tanGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#f39c12;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#d35400;stop-opacity:1" />
                        </linearGradient>
                        
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
                        </marker>
                    </defs>
                    
                    <!-- Scene 1: 单位圆介绍 -->
                    <g id="scene1">
                        <!-- 坐标轴 -->
                        <line x1="100" y1="200" x2="700" y2="200" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="400" y1="350" x2="400" y2="50" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="710" y="205" fill="#34495e" font-size="16">x</text>
                        <text x="405" y="45" fill="#34495e" font-size="16">y</text>
                        
                        <!-- 单位圆 -->
                        <circle cx="400" cy="200" r="100" fill="url(#circleGradient)" stroke="#3498db" stroke-width="2"/>
                        <text x="400" y="320" text-anchor="middle" fill="#3498db" font-size="16">单位圆 (r=1)</text>
                        
                        <!-- 旋转的半径线 -->
                        <g id="rotatingRadius">
                            <line x1="400" y1="200" x2="500" y2="200" stroke="#3498db" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                            
                            <!-- 移动的点P -->
                            <circle cx="500" cy="200" r="6" fill="#e74c3c">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </circle>
                            
                            <!-- 角度标记 -->
                            <path d="M 400 200 L 500 200 A 100 100 0 0 0 470.71 270.71 L 400 200" fill="#3498db" fill-opacity="0.3" stroke="#3498db" stroke-width="1.5">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </path>
                            <text x="450" y="230" text-anchor="middle" fill="#3498db" font-size="16">θ</text>
                            
                            <!-- 坐标线 -->
                            <line x1="400" y1="200" x2="500" y2="200" stroke="#2ecc71" stroke-width="2" stroke-dasharray="5,3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                            <line x1="500" y1="200" x2="500" y2="200" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5,3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                            
                            <!-- 坐标标签 -->
                            <text x="450" y="195" text-anchor="middle" fill="#2ecc71" font-size="14">cosθ</text>
                            <text x="510" y="200" text-anchor="middle" fill="#e74c3c" font-size="14">sinθ</text>
                        </g>
                        
                        <!-- 点P的标签 -->
                        <text x="515" y="200" fill="#e74c3c" font-size="14">P(cosθ, sinθ)</text>
                    </g>
                    
                    <!-- Scene 2: 正弦函数 -->
                    <g id="scene2" style="display: none;">
                        <!-- 坐标轴 -->
                        <line x1="100" y1="200" x2="700" y2="200" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="400" y1="350" x2="400" y2="50" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="710" y="205" fill="#34495e" font-size="16">x</text>
                        <text x="405" y="45" fill="#34495e" font-size="16">y</text>
                        
                        <!-- 单位圆 -->
                        <circle cx="400" cy="200" r="100" fill="url(#circleGradient)" stroke="#3498db" stroke-width="2"/>
                        
                        <!-- 旋转的半径线 -->
                        <g id="rotatingRadius2">
                            <line x1="400" y1="200" x2="500" y2="200" stroke="#3498db" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                            
                            <!-- 移动的点P -->
                            <circle cx="500" cy="200" r="6" fill="#e74c3c">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </circle>
                            
                            <!-- 正弦线 -->
                            <line x1="500" y1="200" x2="500" y2="200" stroke="#e74c3c" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                        </g>
                        
                        <!-- 正弦函数图像 -->
                        <path d="M 100 200 Q 150 150, 200 200 T 300 200 T 400 200 T 500 200 T 600 200 T 700 200" fill="none" stroke="#e74c3c" stroke-width="2"/>
                        <text x="550" y="180" text-anchor="middle" fill="#e74c3c" font-size="16">y = sinθ</text>
                        <text x="480" y="235" text-anchor="middle" fill="#e74c3c" font-size="14">sinθ</text>
                    </g>
                    
                    <!-- Scene 3: 余弦函数 -->
                    <g id="scene3" style="display: none;">
                        <!-- 坐标轴 -->
                        <line x1="100" y1="200" x2="700" y2="200" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="400" y1="350" x2="400" y2="50" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="710" y="205" fill="#34495e" font-size="16">x</text>
                        <text x="405" y="45" fill="#34495e" font-size="16">y</text>
                        
                        <!-- 单位圆 -->
                        <circle cx="400" cy="200" r="100" fill="url(#circleGradient)" stroke="#3498db" stroke-width="2"/>
                        
                        <!-- 旋转的半径线 -->
                        <g id="rotatingRadius3">
                            <line x1="400" y1="200" x2="500" y2="200" stroke="#3498db" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                            
                            <!-- 移动的点P -->
                            <circle cx="500" cy="200" r="6" fill="#2ecc71">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </circle>
                            
                            <!-- 余弦线 -->
                            <line x1="400" y1="200" x2="500" y2="200" stroke="#2ecc71" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                        </g>
                        
                        <!-- 余弦函数图像 -->
                        <path d="M 100 100 Q 150 150, 200 200 T 300 250 T 400 200 T 500 150 T 600 100 T 700 150" fill="none" stroke="#2ecc71" stroke-width="2"/>
                        <text x="550" y="130" text-anchor="middle" fill="#2ecc71" font-size="16">y = cosθ</text>
                        <text x="435" y="195" text-anchor="middle" fill="#2ecc71" font-size="14">cosθ</text>
                    </g>
                    
                    <!-- Scene 4: 正切函数 -->
                    <g id="scene4" style="display: none;">
                        <!-- 坐标轴 -->
                        <line x1="100" y1="200" x2="700" y2="200" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="400" y1="350" x2="400" y2="50" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="710" y="205" fill="#34495e" font-size="16">x</text>
                        <text x="405" y="45" fill="#34495e" font-size="16">y</text>
                        
                        <!-- 单位圆 -->
                        <circle cx="400" cy="200" r="100" fill="url(#circleGradient)" stroke="#3498db" stroke-width="2"/>
                        
                        <!-- 延长线 -->
                        <line x1="400" y1="200" x2="600" y2="200" stroke="#34495e" stroke-width="1" stroke-dasharray="5,3"/>
                        
                        <!-- 旋转的半径线 -->
                        <g id="rotatingRadius4">
                            <line x1="400" y1="200" x2="500" y2="200" stroke="#3498db" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                            
                            <!-- 移动的点P -->
                            <circle cx="500" cy="200" r="6" fill="#f39c12">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </circle>
                            
                            <!-- 切线 -->
                            <line x1="500" y1="200" x2="500" y2="200" stroke="#f39c12" stroke-width="3">
                                <animateTransform attributeName="transform" type="rotate" from="0 400 200" to="360 400 200" dur="10s" repeatCount="indefinite"/>
                            </line>
                        </g>
                        
                        <!-- 正切函数图像 -->
                        <path d="M 100 300 Q 150 250, 200 200 T 300 150 T 400 200 T 500 250 T 600 300" fill="none" stroke="#f39c12" stroke-width="2"/>
                        <text x="550" y="280" text-anchor="middle" fill="#f39c12" font-size="16">y = tanθ</text>
                        <text x="510" y="235" text-anchor="middle" fill="#f39c12" font-size="14">tanθ</text>
                    </g>
                    
                    <!-- Scene 5: 特殊角度值 -->
                    <g id="scene5" style="display: none;">
                        <!-- 坐标轴 -->
                        <line x1="100" y1="200" x2="700" y2="200" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="400" y1="350" x2="400" y2="50" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="710" y="205" fill="#34495e" font-size="16">x</text>
                        <text x="405" y="45" fill="#34495e" font-size="16">y</text>
                        
                        <!-- 单位圆 -->
                        <circle cx="400" cy="200" r="100" fill="url(#circleGradient)" stroke="#3498db" stroke-width="2"/>
                        
                        <!-- 特殊角度标记 -->
                        <!-- 0度 -->
                        <line x1="400" y1="200" x2="500" y2="200" stroke="#34495e" stroke-width="2"/>
                        <text x="510" y="205" fill="#34495e" font-size="14">0°</text>
                        
                        <!-- 30度 -->
                        <line x1="400" y1="200" x2="486.6" y2="150" stroke="#34495e" stroke-width="2"/>
                        <text x="490" y="145" fill="#34495e" font-size="14">30°</text>
                        
                        <!-- 45度 -->
                        <line x1="400" y1="200" x2="470.71" y2="270.71" stroke="#34495e" stroke-width="2"/>
                        <text x="475" y="275" fill="#34495e" font-size="14">45°</text>
                        
                        <!-- 60度 -->
                        <line x1="400" y1="200" x2="450" y2="286.6" stroke="#34495e" stroke-width="2"/>
                        <text x="455" y="295" fill="#34495e" font-size="14">60°</text>
                        
                        <!-- 90度 -->
                        <line x1="400" y1="200" x2="400" y2="100" stroke="#34495e" stroke-width="2"/>
                        <text x="405" y="95" fill="#34495e" font-size="14">90°</text>
                        
                        <!-- 特殊角度值表格 -->
                        <rect x="550" y="100" width="200" height="180" fill="white" fill-opacity="0.8" stroke="#34495e" stroke-width="1" rx="5"/>
                        <text x="650" y="125" text-anchor="middle" fill="#34495e" font-size="16" font-weight="bold">特殊角度值</text>
                        
                        <line x1="550" y1="140" x2="750" y2="140" stroke="#34495e" stroke-width="1"/>
                        <text x="580" y="160" text-anchor="middle" fill="#34495e" font-size="14">角度</text>
                        <text x="630" y="160" text-anchor="middle" fill="#e74c3c" font-size="14">sin</text>
                        <text x="680" y="160" text-anchor="middle" fill="#2ecc71" font-size="14">cos</text>
                        <text x="720" y="160" text-anchor="middle" fill="#f39c12" font-size="14">tan</text>
                        
                        <line x1="550" y1="170" x2="750" y2="170" stroke="#34495e" stroke-width="1"/>
                        
                        <text x="580" y="190" text-anchor="middle" fill="#34495e" font-size="14">30°</text>
                        <text x="630" y="190" text-anchor="middle" fill="#e74c3c" font-size="14">1/2</text>
                        <text x="680" y="190" text-anchor="middle" fill="#2ecc71" font-size="14">√3/2</text>
                        <text x="720" y="190" text-anchor="middle" fill="#f39c12" font-size="14">√3/3</text>
                        
                        <text x="580" y="215" text-anchor="middle" fill="#34495e" font-size="14">45°</text>
                        <text x="630" y="215" text-anchor="middle" fill="#e74c3c" font-size="14">√2/2</text>
                        <text x="680" y="215" text-anchor="middle" fill="#2ecc71" font-size="14">√2/2</text>
                        <text x="720" y="215" text-anchor="middle" fill="#f39c12" font-size="14">1</text>
                        
                        <text x="580" y="240" text-anchor="middle" fill="#34495e" font-size="14">60°</text>
                        <text x="630" y="240" text-anchor="middle" fill="#e74c3c" font-size="14">√3/2</text>
                        <text x="680" y="240" text-anchor="middle" fill="#2ecc71" font-size="14">1/2</text>
                        <text x="720" y="240" text-anchor="middle" fill="#f39c12" font-size="14">√3</text>
                    </g>
                    
                    <!-- Scene 6: 三角函数应用 -->
                    <g id="scene6" style="display: none;">
                        <!-- 坐标轴 -->
                        <line x1="100" y1="200" x2="700" y2="200" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="400" y1="350" x2="400" y2="50" stroke="#34495e" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="710" y="205" fill="#34495e" font-size="16">x</text>
                        <text x="405" y="45" fill="#34495e" font-size="16">y</text>
                        
                        <!-- 直角三角形 -->
                        <path d="M 300 250 L 500 250 L 500 150 Z" fill="none" stroke="#34495e" stroke-width="2"/>
                        <text x="400" y="270" text-anchor="middle" fill="#34495e" font-size="16">a</text>
                        <text x="510" y="200" text-anchor="middle" fill="#34495e" font-size="16">b</text>
                        <text x="390" y="190" text-anchor="middle" fill="#34495e" font-size="16">c</text>
                        <text x="320" y="240" text-anchor="middle" fill="#34495e" font-size="14">θ</text>
                        
                        <!-- 应用示例 -->
                        <rect x="550" y="100" width="200" height="150" fill="white" fill-opacity="0.8" stroke="#34495e" stroke-width="1" rx="5"/>
                        <text x="650" y="125" text-anchor="middle" fill="#34495e" font-size="16" font-weight="bold">三角函数应用</text>
                        
                        <text x="570" y="155" fill="#34495e" font-size="14">sinθ = 对边/斜边 = b/c</text>
                        <text x="570" y="180" fill="#34495e" font-size="14">cosθ = 邻边/斜边 = a/c</text>
                        <text x="570" y="205" fill="#34495e" font-size="14">tanθ = 对边/邻边 = b/a</text>
                        
                        <text x="570" y="235" fill="#34495e" font-size="14">应用: 测量高度、距离</text>
                    </g>
                </svg>
            </div>
        </div>
        
        <div class="subtitle-container">
            <div class="subtitle" id="subtitle"></div>
        </div>
        
        <div class="controls">
            <button class="control-btn" id="playBtn" title="播放" disabled>
                <span id="playIcon">▶</span>
            </button>
            <button class="control-btn" id="muteBtn" title="静音">
                <span id="muteIcon">🔊</span>
            </button>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                    <div class="progress-handle" id="progressHandle"></div>
                </div>
                <div class="time-display" id="timeDisplay">00:00 / 00:00</div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        © 2023 https://study11.ai/
    </div>
    
    <!-- 为每个场景创建一个音频元素 -->
    <div id="audioContainer"></div>
    
    <script>
        // 动画场景数据
        const scenes = [
            {
                title: "单位圆与三角函数",
                subtitle: "三角函数是描述角度与边长关系的数学函数。在单位圆中，任意角度θ对应的点P的坐标是(cosθ, sinθ)。",
                text: "三角函数是数学中描述角度与边长关系的重要函数。在单位圆（半径为1的圆）中，任意角度θ对应的点P的坐标就是(cosθ, sinθ)。这里，cosθ表示点P的x坐标，sinθ表示点P的y坐标。这种几何表示直观地展示了三角函数的基本概念。",
                action: () => {
                    document.getElementById('sceneTitle').textContent = "单位圆与三角函数";
                    document.getElementById('textContent').textContent = "三角函数是数学中描述角度与边长关系的重要函数。在单位圆（半径为1的圆）中，任意角度θ对应的点P的坐标就是(cosθ, sinθ)。这里，cosθ表示点P的x坐标，sinθ表示点P的y坐标。这种几何表示直观地展示了三角函数的基本概念。";
                    
                    // 显示场景1，隐藏其他场景
                    for (let i = 1; i <= 6; i++) {
                        document.getElementById(`scene${i}`).style.display = i === 1 ? 'block' : 'none';
                    }
                    
                    document.getElementById('textPanel').classList.add('active');
                    document.getElementById('sceneTitle').classList.add('active');
                }
            },
            {
                title: "正弦函数",
                subtitle: "正弦函数sinθ表示单位圆上点P的y坐标。随着角度θ从0°增加到360°，sinθ的值在-1到1之间周期性变化。",
                text: "正弦函数sinθ表示单位圆上点P的y坐标。当θ=0°时，点P在(1,0)，sin0°=0；当θ=90°时，点P在(0,1)，sin90°=1；当θ=180°时，点P在(-1,0)，sin180°=0；当θ=270°时，点P在(0,-1)，sin270°=-1；当θ=360°时，点P回到(1,0)，sin360°=0。正弦函数的周期是360°或2π弧度。",
                action: () => {
                    document.getElementById('sceneTitle').textContent = "正弦函数";
                    document.getElementById('textContent').textContent = "正弦函数sinθ表示单位圆上点P的y坐标。当θ=0°时，点P在(1,0)，sin0°=0；当θ=90°时，点P在(0,1)，sin90°=1；当θ=180°时，点P在(-1,0)，sin180°=0；当θ=270°时，点P在(0,-1)，sin270°=-1；当θ=360°时，点P回到(1,0)，sin360°=0。正弦函数的周期是360°或2π弧度。";
                    
                    // 显示场景2，隐藏其他场景
                    for (let i = 1; i <= 6; i++) {
                        document.getElementById(`scene${i}`).style.display = i === 2 ? 'block' : 'none';
                    }
                }
            },
            {
                title: "余弦函数",
                subtitle: "余弦函数cosθ表示单位圆上点P的x坐标。随着角度θ从0°增加到360°，cosθ的值在-1到1之间周期性变化。",
                text: "余弦函数cosθ表示单位圆上点P的x坐标。当θ=0°时，点P在(1,0)，cos0°=1；当θ=90°时，点P在(0,1)，cos90°=0；当θ=180°时，点P在(-1,0)，cos180°=-1；当θ=270°时，点P在(0,-1)，cos270°=0；当θ=360°时，点P回到(1,0)，cos360°=1。余弦函数的周期也是360°或2π弧度。",
                action: () => {
                    document.getElementById('sceneTitle').textContent = "余弦函数";
                    document.getElementById('textContent').textContent = "余弦函数cosθ表示单位圆上点P的x坐标。当θ=0°时，点P在(1,0)，cos0°=1；当θ=90°时，点P在(0,1)，cos90°=0；当θ=180°时，点P在(-1,0)，cos180°=-1；当θ=270°时，点P在(0,-1)，cos270°=0；当θ=360°时，点P回到(1,0)，cos360°=1。余弦函数的周期也是360°或2π弧度。";
                    
                    // 显示场景3，隐藏其他场景
                    for (let i = 1; i <= 6; i++) {
                        document.getElementById(`scene${i}`).style.display = i === 3 ? 'block' : 'none';
                    }
                }
            },
            {
                title: "正切函数",
                subtitle: "正切函数tanθ等于sinθ除以cosθ，即对边与邻边的比值。在单位圆中，它表示点P的y坐标与x坐标的比值。",
                text: "正切函数tanθ等于sinθ除以cosθ，即tanθ=sinθ/cosθ。在单位圆中，它表示点P的y坐标与x坐标的比值。当θ=0°时，tan0°=0；当θ=45°时，tan45°=1；当θ=90°时，cos90°=0，tan90°无定义（趋向于无穷大）；当θ=180°时，tan180°=0；当θ=270°时，tan270°也无定义。正切函数的周期是180°或π弧度。",
                action: () => {
                    document.getElementById('sceneTitle').textContent = "正切函数";
                    document.getElementById('textContent').textContent = "正切函数tanθ等于sinθ除以cosθ，即tanθ=sinθ/cosθ。在单位圆中，它表示点P的y坐标与x坐标的比值。当θ=0°时，tan0°=0；当θ=45°时，tan45°=1；当θ=90°时，cos90°=0，tan90°无定义（趋向于无穷大）；当θ=180°时，tan180°=0；当θ=270°时，tan270°也无定义。正切函数的周期是180°或π弧度。";
                    
                    // 显示场景4，隐藏其他场景
                    for (let i = 1; i <= 6; i++) {
                        document.getElementById(`scene${i}`).style.display = i === 4 ? 'block' : 'none';
                    }
                }
            },
            {
                title: "特殊角度值",
                subtitle: "在0°、30°、45°、60°、90°等特殊角度下，三角函数的值具有简单的表达形式，这些值在计算中经常使用。",
                text: "在0°、30°、45°、60°、90°等特殊角度下，三角函数的值具有简单的表达形式。例如：sin30°=1/2，cos30°=√3/2，tan30°=√3/3；sin45°=√2/2，cos45°=√2/2，tan45°=1；sin60°=√3/2，cos60°=1/2，tan60°=√3。这些特殊角度的值在数学计算和实际问题解决中经常使用，需要熟记。",
                action: () => {
                    document.getElementById('sceneTitle').textContent = "特殊角度值";
                    document.getElementById('textContent').textContent = "在0°、30°、45°、60°、90°等特殊角度下，三角函数的值具有简单的表达形式。例如：sin30°=1/2，cos30°=√3/2，tan30°=√3/3；sin45°=√2/2，cos45°=√2/2，tan45°=1；sin60°=√3/2，cos60°=1/2，tan60°=√3。这些特殊角度的值在数学计算和实际问题解决中经常使用，需要熟记。";
                    
                    // 显示场景5，隐藏其他场景
                    for (let i = 1; i <= 6; i++) {
                        document.getElementById(`scene${i}`).style.display = i === 5 ? 'block' : 'none';
                    }
                }
            },
            {
                title: "三角函数的应用",
                subtitle: "三角函数在测量、物理、工程等领域有广泛应用，如测量建筑物高度、计算力的分解、分析周期性现象等。",
                text: "三角函数在实际生活中有广泛的应用。在测量中，可以利用三角函数计算建筑物的高度或河的宽度；在物理学中，三角函数用于力的分解、简谐振动分析；在工程学中，用于设计机械结构和电路分析；在计算机图形学中，用于旋转和变换图形。掌握三角函数的基本概念和计算方法，对解决许多实际问题都非常有帮助。",
                action: () => {
                    document.getElementById('sceneTitle').textContent = "三角函数的应用";
                    document.getElementById('textContent').textContent = "三角函数在实际生活中有广泛的应用。在测量中，可以利用三角函数计算建筑物的高度或河的宽度；在物理学中，三角函数用于力的分解、简谐振动分析；在工程学中，用于设计机械结构和电路分析；在计算机图形学中，用于旋转和变换图形。掌握三角函数的基本概念和计算方法，对解决许多实际问题都非常有帮助。";
                    
                    // 显示场景6，隐藏其他场景
                    for (let i = 1; i <= 6; i++) {
                        document.getElementById(`scene${i}`).style.display = i === 6 ? 'block' : 'none';
                    }
                }
            }
        ];
        
        // 全局变量
        let currentScene = 0;
        let isPlaying = false;
        let isMuted = false;
        let audioElements = [];
        let sceneStartTime = 0;
        let totalDuration = 0;
        let sceneTimestamps = []; // 记录每个场景的开始时间戳
        let isDragging = false;
        let audioCache = {}; // 音频缓存对象
        let cacheExpiry = 7 * 24 * 60 * 60 * 1000; // 缓存有效期：7天
        
        // DOM元素
        const playBtn = document.getElementById('playBtn');
        const playIcon = document.getElementById('playIcon');
        const muteBtn = document.getElementById('muteBtn');
        const muteIcon = document.getElementById('muteIcon');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        const progressHandle = document.getElementById('progressHandle');
        const subtitle = document.getElementById('subtitle');
        const loading = document.getElementById('loading');
        const audioContainer = document.getElementById('audioContainer');
        const cacheIndicator = document.getElementById('cacheIndicator');
        const timeDisplay = document.getElementById('timeDisplay');
        
        // 初始化音频缓存
        function initAudioCache() {
            try {
                // 尝试从localStorage加载缓存
                const cachedData = localStorage.getItem('ttsAudioCache');
                if (cachedData) {
                    const parsedCache = JSON.parse(cachedData);
                    
                    // 检查缓存是否过期
                    const now = Date.now();
                    for (const key in parsedCache) {
                        if (parsedCache[key].timestamp + cacheExpiry < now) {
                            delete parsedCache[key]; // 删除过期缓存
                        }
                    }
                    
                    audioCache = parsedCache;
                    // 保存更新后的缓存
                    localStorage.setItem('ttsAudioCache', JSON.stringify(audioCache));
                }
            } catch (e) {
                console.error('初始化音频缓存失败:', e);
                audioCache = {};
            }
        }
        
        // 将Blob转换为Base64
        function blobToBase64(blob) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(blob);
            });
        }
        
        // 将Base64转换为Blob
        function base64ToBlob(base64) {
            // 分离Base64数据和MIME类型
            const parts = base64.split(';base64,');
            const contentType = parts[0].split(':')[1];
            const raw = window.atob(parts[1]);
            
            // 转换为ArrayBuffer
            const uInt8Array = new Uint8Array(raw.length);
            for (let i = 0; i < raw.length; ++i) {
                uInt8Array[i] = raw.charCodeAt(i);
            }
            
            // 创建Blob
            return new Blob([uInt8Array], { type: contentType });
        }
        
        // 保存音频到缓存
        async function saveAudioToCache(text, blob) {
            try {
                // 将Blob转换为Base64字符串
                const base64Data = await blobToBase64(blob);
                
                audioCache[text] = {
                    data: base64Data,
                    timestamp: Date.now()
                };
                localStorage.setItem('ttsAudioCache', JSON.stringify(audioCache));
            } catch (e) {
                console.error('保存音频缓存失败:', e);
            }
        }
        
        // 从缓存获取音频
        function getAudioFromCache(text) {
            if (audioCache[text] && audioCache[text].timestamp + cacheExpiry > Date.now()) {
                try {
                    // 将Base64转换回Blob
                    const blob = base64ToBlob(audioCache[text].data);
                    return URL.createObjectURL(blob);
                } catch (e) {
                    console.error('从缓存恢复音频失败:', e);
                    return null;
                }
            }
            return null;
        }
        
        // 初始化音频元素
        function initializeAudioElements() {
            // 清空容器
            audioContainer.innerHTML = '';
            audioElements = [];
            
            // 为每个场景创建音频元素
            scenes.forEach((scene, index) => {
                const audio = document.createElement('audio');
                audio.id = `audio-${index}`;
                audio.preload = 'auto';
                audioContainer.appendChild(audio);
                audioElements.push(audio);
            });
        }
        
        // 合成单个场景的语音
        async function synthesizeSceneSpeech(index) {
            const text = scenes[index].subtitle;
            const encodedText = encodeURIComponent(text);
            
            // 检查缓存
            const cachedAudioUrl = getAudioFromCache(text);
            if (cachedAudioUrl) {
                // 显示缓存指示器
                cacheIndicator.classList.add('active');
                setTimeout(() => {
                    cacheIndicator.classList.remove('active');
                }, 2000);
                
                // 使用缓存的音频
                audioElements[index].src = cachedAudioUrl;
                
                // 等待音频加载完成以获取时长
                return new Promise((resolve) => {
                    audioElements[index].onloadedmetadata = () => {
                        scenes[index].duration = audioElements[index].duration * 1000; // 转换为毫秒
                        resolve();
                    };
                });
            }
            
            // 缓存中没有，请求TTS服务
            try {
                const response = await fetch(`https://javalinux.explanation.fun/tts?input=${encodedText}`);
                const blob = await response.blob();
                const audioUrl = URL.createObjectURL(blob);
                
                // 保存到缓存
                await saveAudioToCache(text, blob);
                
                audioElements[index].src = audioUrl;
                
                // 等待音频加载完成以获取时长
                return new Promise((resolve) => {
                    audioElements[index].onloadedmetadata = () => {
                        scenes[index].duration = audioElements[index].duration * 1000; // 转换为毫秒
                        resolve();
                    };
                });
            } catch (error) {
                console.error(`场景 ${index} TTS合成失败:`, error);
                // 使用默认持续时间
                scenes[index].duration = 5000;
                resolve();
            }
        }
        
        // 格式化时间显示
        function formatTime(milliseconds) {
            const totalSeconds = Math.floor(milliseconds / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // 更新时间显示
        function updateTimeDisplay(currentTime, totalTime) {
            const currentTimeStr = formatTime(currentTime);
            const totalTimeStr = formatTime(totalTime);
            timeDisplay.textContent = `${currentTimeStr} / ${totalTimeStr}`;
        }
        
        // 预加载所有音频
        async function preloadAllAudio() {
            loading.classList.add('active');
            playBtn.disabled = true;
            
            // 初始化音频缓存
            initAudioCache();
            
            initializeAudioElements();
            
            // 顺序合成每个场景的语音
            for (let i = 0; i < scenes.length; i++) {
                await synthesizeSceneSpeech(i);
            }
            
            // 计算时间戳
            calculateTimestamps();
            
            // 初始化时间显示
            updateTimeDisplay(0, totalDuration);
            
            loading.classList.remove('active');
            playBtn.disabled = false;
        }
        
        // 计算每个场景的时间戳
        function calculateTimestamps() {
            sceneTimestamps = [];
            let accumulatedTime = 0;
            
            scenes.forEach((scene) => {
                sceneTimestamps.push(accumulatedTime);
                accumulatedTime += scene.duration;
            });
            
            totalDuration = accumulatedTime;
        }
        
        // 更新进度条
        function updateProgress() {
            if (!isPlaying) return;
            
            const currentAudio = audioElements[currentScene];
            if (!currentAudio) return;
            
            // 计算当前时间点
            const sceneStartTime = sceneTimestamps[currentScene];
            const currentTime = sceneStartTime + (currentAudio.currentTime * 1000);
            const progress = Math.min((currentTime / totalDuration) * 100, 100);
            
            progressFill.style.width = progress + '%';
            progressHandle.style.left = progress + '%';
            
            // 更新时间显示
            updateTimeDisplay(currentTime, totalDuration);
            
            if (progress >= 100) {
                stopAnimation();
            } else {
                requestAnimationFrame(updateProgress);
            }
        }
        
        // 播放指定场景
        function playScene(sceneIndex) {
            if (sceneIndex >= scenes.length) {
                stopAnimation();
                return;
            }
            
            // 停止当前音频
            if (currentScene < audioElements.length && audioElements[currentScene]) {
                audioElements[currentScene].pause();
            }
            
            currentScene = sceneIndex;
            const scene = scenes[sceneIndex];
            const audio = audioElements[sceneIndex];
            
            // 更新字幕和动画
            subtitle.textContent = scene.subtitle;
            subtitle.classList.add('active');
            scene.action();
            
            // 播放音频
            if (audio && !isMuted) {
                audio.currentTime = 0;
                audio.play().catch(e => console.log('音频播放失败:', e));
                
                // 音频结束时播放下一个场景
                audio.onended = () => {
                    subtitle.classList.remove('active');
                    playScene(currentScene + 1);
                };
            } else {
                // 如果静音或没有音频，使用定时器
                setTimeout(() => {
                    subtitle.classList.remove('active');
                    playScene(currentScene + 1);
                }, scene.duration);
            }
        }
        
        // 开始动画
        function startAnimation() {
            if (isPlaying) return;
            
            isPlaying = true;
            playIcon.textContent = '⏸';
            currentScene = 0;
            
            // 开始播放第一个场景
            playScene(0);
            updateProgress();
        }
        
        // 暂停动画
        function pauseAnimation() {
            isPlaying = false;
            playIcon.textContent = '▶';
            
            // 暂停当前音频
            if (currentScene < audioElements.length && audioElements[currentScene]) {
                audioElements[currentScene].pause();
            }
        }
        
        // 停止动画
        function stopAnimation() {
            pauseAnimation();
            currentScene = 0;
            progressFill.style.width = '0%';
            progressHandle.style.left = '0%';
            subtitle.textContent = '';
            
            // 重置时间显示
            updateTimeDisplay(0, totalDuration);
            
            // 重置场景
            document.getElementById('textPanel').classList.remove('active');
            document.getElementById('sceneTitle').classList.remove('active');
            
            // 隐藏所有场景
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`scene${i}`).style.display = 'none';
            }
        }
        
        // 切换静音
        function toggleMute() {
            isMuted = !isMuted;
            muteIcon.textContent = isMuted ? '🔇' : '🔊';
            
            // 设置所有音频元素的静音状态
            audioElements.forEach(audio => {
                audio.muted = isMuted;
            });
        }
        
        // 进度条控制
        function handleProgressClick(e) {
            const rect = progressBar.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const percentage = Math.max(0, Math.min(100, (x / rect.width) * 100));
            
            progressFill.style.width = percentage + '%';
            progressHandle.style.left = percentage + '%';
            
            // 计算对应的时间点
            const targetTime = (percentage / 100) * totalDuration;
            
            // 更新时间显示
            updateTimeDisplay(targetTime, totalDuration);
            
            // 找到对应的场景
            let targetScene = 0;
            for (let i = 0; i < sceneTimestamps.length; i++) {
                if (targetTime >= sceneTimestamps[i]) {
                    targetScene = i;
                } else {
                    break;
                }
            }
            
            // 如果正在播放，跳转到目标场景
            if (isPlaying) {
                // 停止当前音频
                if (currentScene < audioElements.length && audioElements[currentScene]) {
                    audioElements[currentScene].pause();
                }
                
                // 计算在目标场景中的时间偏移
                const sceneOffset = targetTime - sceneTimestamps[targetScene];
                
                // 播放目标场景
                currentScene = targetScene;
                const scene = scenes[targetScene];
                const audio = audioElements[targetScene];
                
                // 更新字幕和动画
                subtitle.textContent = scene.subtitle;
                subtitle.classList.add('active');
                scene.action();
                
                // 播放音频（从指定时间点开始）
                if (audio && !isMuted) {
                    audio.currentTime = sceneOffset / 1000; // 转换为秒
                    audio.play().catch(e => console.log('音频播放失败:', e));
                    
                    // 音频结束时播放下一个场景
                    audio.onended = () => {
                        subtitle.classList.remove('active');
                        playScene(currentScene + 1);
                    };
                } else {
                    // 如果静音或没有音频，使用定时器
                    setTimeout(() => {
                        subtitle.classList.remove('active');
                        playScene(currentScene + 1);
                    }, scene.duration - sceneOffset);
                }
            }
        }
        
        // 事件监听
        playBtn.addEventListener('click', () => {
            if (isPlaying) {
                pauseAnimation();
            } else {
                startAnimation();
            }
        });
        
        muteBtn.addEventListener('click', toggleMute);
        progressBar.addEventListener('click', handleProgressClick);
        
        // 进度条拖动
        progressHandle.addEventListener('mousedown', () => isDragging = true);
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                handleProgressClick(e);
            }
        });
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
            }
        });
        
        // 初始化
        window.addEventListener('load', () => {
            preloadAllAudio();
        });
    </script>
</body>
</html>